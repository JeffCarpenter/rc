#!/bin/zsh

__comp=logout

if [ ! -x ~/.rsetup/${__comp}/run.d/${HOST} ] ; then
    if [ ! -d ~/.rsetup/${__comp}/env.d/${HOST} ] ; then
        rm -f ~/.rsetup/${__comp}/env.d/${HOST}
    fi
    mkdir ~/.rsetup/${__comp}/env.d/${HOST}
    cp ~/.rsetup/${__comp}/run.tmpl ~/.rsetup/${__comp}/run.d/${HOST}
fi

[ -r ~/.rsetup/${__comp}/run.d/${HOST} ] && ~/.rsetup/${__comp}/run.d/${HOST}

unset __comp



# for startup in logout ; do
#    [ -r ~/.rsetup/$startup/env ] && . ~/.rsetup/$startup/env
# done
# for startup in logout ; do
#    [ -r ~/.rsetup/$startup/run ] && ~/.rsetup/$startup/run
# done


if [ ${SSH_AGENT_PID+1} == 1 ]; then
   ssh-add -D
   ssh-agent -k > /dev/null 2>&1
   kill $SSH_AGENT_PID
   unset SSH_AGENT_PID
   unset SSH_AUTH_SOCK
   pkill ssh-agent
fi

if pgrep leave >& /dev/null ; then
    pkill leave >& /dev/null
    pkill -9 leave >& /dev/null
fi
